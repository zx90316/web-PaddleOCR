<!DOCTYPE html>
<!--
PaddleOCR Web Interface
Copyright (c) 2025

This project provides a web interface for PaddleOCR.
This software uses PaddleOCR, which is licensed under Apache License 2.0.
Core OCR functionality is provided by PaddleOCR.
-->
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PaddleOCR 圖片文檔識別服務</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- Header 區域 -->
        <header class="app-header">
            <div>
                <h1>🔍 PaddleOCR 圖片文檔識別服務</h1>
                <p>智慧圖片與PDF文檔文字識別與關鍵字提取平台</p>
            </div>
            <div style="display: flex; gap: 15px; align-items: center;">
                <a href="/batch-tasks" class="btn-link" style="padding: 10px 20px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; text-decoration: none; border-radius: 8px; font-weight: 600;">📋 批次任務管理</a>
                <a href="/admin" class="btn-link" style="padding: 10px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; border-radius: 8px; font-weight: 600;">🛠️ 管理後台</a>
                <span id="statusIndicator" class="status-indicator status-ready">準備就緒</span>
            </div>
        </header>
        
        <!-- Left Sidebar 區域 - 輸入控制 -->
        <aside class="app-sidebar">
            <h2 class="sidebar-title">📋 操作面板</h2>

            <!-- 模式選擇 -->
            <div class="form-group mode-selector">
                <label>處理模式：</label>
                <div class="mode-tabs">
                    <button type="button" class="mode-tab active" data-mode="standard">標準模式</button>
                    <button type="button" class="mode-tab" data-mode="matching">頁面匹配模式</button>
                </div>
            </div>

            <form id="uploadForm">
                <!-- 標準模式：單一檔案上傳 -->
                <div class="form-group mode-content" id="standardMode">
                    <label for="imageFile">選擇圖片或PDF檔案：</label>
                    <input type="file" id="imageFile" name="file" accept="image/*,.pdf">
                    
                    <!-- 檔案預覽區域 -->
                    <div id="imagePreview" class="sidebar-image-preview" style="display: none;">
                        <img id="uploadedImage" src="" alt="上傳的圖片" class="sidebar-preview-image" style="display: none;">
                        <div id="pdfPreview" class="sidebar-pdf-preview" style="display: none;">
                            <i class="pdf-icon">📄</i>
                            <span class="pdf-text">PDF檔案已選擇</span>
                        </div>
                        <p id="imageFileName" class="sidebar-image-filename"></p>
                    </div>
                </div>

                <!-- 頁面匹配模式：PDF + 範本圖片上傳 -->
                <div class="form-group mode-content" id="matchingMode" style="display: none;">
                    <label for="pdfFile">選擇PDF檔案：</label>
                    <input type="file" id="pdfFile" name="pdf_file" accept=".pdf">
                    <div id="pdfFilePreview" class="sidebar-image-preview" style="display: none;">
                        <div class="sidebar-pdf-preview">
                            <i class="pdf-icon">📄</i>
                            <span class="pdf-text">PDF檔案已選擇</span>
                        </div>
                        <p id="pdfFileName" class="sidebar-image-filename"></p>
                    </div>

                    <label for="positiveTemplates" style="margin-top: 15px;">正例範本圖片（必填，可多選）：</label>
                    <input type="file" id="positiveTemplates" name="positive_templates" accept="image/*" multiple>
                    <div id="positivePreview" class="template-preview"></div>

                    <label for="negativeTemplates" style="margin-top: 15px;">反例範本圖片（可選，可多選）：</label>
                    <input type="file" id="negativeTemplates" name="negative_templates" accept="image/*" multiple>
                    <div id="negativePreview" class="template-preview"></div>

                    <div class="threshold-controls" style="margin-top: 15px;">
                        <label for="positiveThreshold">正例相似度閾值：<span id="posThresholdValue">0.95</span></label>
                        <input type="range" id="positiveThreshold" name="positive_threshold" min="0" max="1" step="0.01" value="0.95">

                        <label for="negativeThreshold" style="margin-top: 10px;">反例相似度閾值：<span id="negThresholdValue">0.55</span></label>
                        <input type="range" id="negativeThreshold" name="negative_threshold" min="0" max="1" step="0.01" value="0.55">
                    </div>

                    <div class="form-group" style="margin-top: 15px;">
                        <label>
                            <input type="checkbox" id="skipVoided" name="skip_voided">
                            跳過廢止頁面
                        </label>
                        <p style="font-size: 12px; color: #6b7280; margin-top: 5px; margin-left: 20px;">啟用後，系統會檢測候選頁面是否包含「廢止」、「作廢」、「VOID」、「CANCELLED」等關鍵字，並自動跳過這些頁面</p>
                    </div>

                    <div class="form-group" id="topNVoidCheckGroup" style="display: none; margin-top: 10px;">
                        <label for="topNVoidCheck">檢查候選數量：</label>
                        <input type="number" id="topNVoidCheck" name="top_n_for_void_check" value="5" min="1" max="20" style="width: 80px;">
                        <p style="font-size: 12px; color: #6b7280; margin-top: 5px;">將檢查前 N 個候選頁面是否為廢止頁面（默認: 5）</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="keyList">需要提取的關鍵字 (每行一個)：</label>
                    <textarea id="keyList" name="key_list" placeholder="請輸入需要提取的關鍵字，例如：&#10;製作日期&#10;報告編號&#10;申請者名稱"></textarea>
                </div>
                
                <div class="form-group">
                    <label>預設關鍵字（點擊加入）：</label>
                    <div class="preset-keywords">
                        <div class="keyword-category">
                            <h6>📋審查報告</h6>
                            <button type="button" class="keyword-btn" data-keyword="製作日期">製作日期</button>
                            <button type="button" class="keyword-btn" data-keyword="報告編號">報告編號</button>
                            <button type="button" class="keyword-btn" data-keyword="報告類別">報告類別</button>
                            <button type="button" class="keyword-btn" data-keyword="申請者名稱">申請者名稱</button>
                            <button type="button" class="keyword-btn" data-keyword="申請者地址">申請者地址</button>
                            <button type="button" class="keyword-btn" data-keyword="申請法規項目名稱">申請法規項目名稱</button>
                            <button type="button" class="keyword-btn" data-keyword="廠牌">廠牌</button>
                            <button type="button" class="keyword-btn" data-keyword="製造廠地址">製造廠地址</button>
                            <button type="button" class="keyword-btn" data-keyword="型式系列">型式系列</button>
                            <button type="button" class="keyword-btn" data-keyword="型式名稱">型式名稱</button>
                        </div>
                        
                        <div class="keyword-category">
                            <h6>📷 完成車照片</h6>
                            <button type="button" class="keyword-btn" data-keyword="車身號碼">車身號碼</button>
                            <button type="button" class="keyword-btn" data-keyword="引擎號碼">引擎號碼</button>
                            <button type="button" class="keyword-btn" data-keyword="車輛型式">車輛型式</button>
                            <button type="button" class="keyword-btn" data-keyword="全長">全長</button>
                            <button type="button" class="keyword-btn" data-keyword="全寬">全寬</button>
                            <button type="button" class="keyword-btn" data-keyword="全高">全高</button>
                            <button type="button" class="keyword-btn" data-keyword="後懸">後懸</button>
                            <button type="button" class="keyword-btn" data-keyword="軸距">軸距</button>
                            <button type="button" class="keyword-btn" data-keyword="最遠軸距">最遠軸距</button>
                            <button type="button" class="keyword-btn" data-keyword="前輪輪距">前輪輪距</button>
                            <button type="button" class="keyword-btn" data-keyword="後輪輪距">後輪輪距</button>
                        </div>
                        
                        <div class="keyword-actions">
                            <button type="button" class="clear-btn">清空關鍵字</button>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="useLLM" name="use_llm" checked>
                        使用LLM提取結果
                    </label>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="useOrientation" name="use_doc_orientation_classify">
                        使用文檔方向分類
                    </label>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="useUnwarping" name="use_doc_unwarping">
                        使用文檔去彎曲
                    </label>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="useTextlineOrientation" name="use_textline_orientation">
                        使用文本行方向分類
                    </label>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="useSealRecognition" name="use_seal_recognition">
                        使用印章文本識別
                    </label>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="useTableRecognition" name="use_table_recognition" checked>
                        使用表格識別
                    </label>
                </div>
                
                <button type="submit">上傳並識別</button>
            </form>
        </aside>
        
        <!-- Right Main 區域 - 結果顯示 -->
        <main class="app-main">
            <h2 class="main-title">📊 識別結果</h2>
            
            <div id="result" style="display: none;"></div>
            
            <div class="result-placeholder" id="placeholder">
                <h3>🎯 等待處理</h3>
                <p>請在左側選擇圖片或PDF檔案並設定關鍵字，然後點擊「上傳並識別」按鈕開始處理。</p>
            </div>
        </main>
    </div>
    <footer class="app-footer">
        <p>© 2025 PaddleOCR Web Interface | 基於 <a href="https://github.com/PaddlePaddle/PaddleOCR" target="_blank">PaddleOCR</a></p>
    </footer>

    <!-- 圖片放大預覽 Modal -->
    <div id="imageModal" class="image-modal">
        <span class="modal-close">&times;</span>
        <img id="modalImage" class="modal-image" alt="放大預覽">
        <div class="modal-caption"></div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
