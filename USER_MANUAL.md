# PaddleOCR 文檔智能識別系統 - 使用者操作手冊

**版本**: 1.0
**最後更新**: 2025-01-05
**適用對象**: 內部使用人員

---

## 📋 目錄

1. [系統簡介](#系統簡介)
2. [系統需求](#系統需求)
3. [登入與存取](#登入與存取)
4. [功能說明](#功能說明)
   - [單檔 OCR 處理](#單檔-ocr-處理)
   - [PDF 頁面匹配](#pdf-頁面匹配)
   - [批次處理](#批次處理)
5. [安全注意事項](#安全注意事項)
6. [常見問題](#常見問題)
7. [故障排除](#故障排除)
8. [聯絡支援](#聯絡支援)

---

## 系統簡介

### 什麼是 PaddleOCR 文檔智能識別系統?

本系統是一套**內部使用的文檔處理工具**,專門用於:
- 自動識別文檔中的文字 (OCR)
- 從文檔中擷取特定關鍵字資訊
- 批次處理大量 PDF 文檔
- 智能匹配 PDF 中的特定頁面

### 主要功能

| 功能 | 說明 | 適用情境 |
|------|------|----------|
| **單檔OCR** | 上傳單一圖片或PDF進行文字識別 | 處理少量文檔 |
| **頁面匹配** | 從多頁PDF中自動找出特定格式頁面 | 從公文中找出正本頁 |
| **批次處理** | 一次處理數百至數千份PDF文檔 | 大量文檔批次擷取 |

### 系統特色

✅ **本地處理**: 所有資料處理均在內部伺服器,不上傳外部
✅ **高準確度**: 採用 PaddleOCR 引擎,中英文識別準確
✅ **智能擷取**: 使用 AI 模型自動擷取關鍵字
✅ **批次高效**: 支援批次處理,自動化處理流程

---

## 系統需求

### 使用者端需求

- **瀏覽器**: Chrome 90+, Edge 90+, Firefox 88+ (建議使用 Chrome)
- **網路**: 需連接內部網路
- **螢幕解析度**: 1366x768 以上 (建議 1920x1080)

### 支援的檔案格式

| 類型 | 格式 | 檔案大小限制 |
|------|------|-------------|
| 圖片 | JPG, PNG, BMP, TIFF | 單檔 < 50MB |
| 文檔 | PDF | 單檔 < 100MB |

⚠️ **注意**:
- 圖片解析度建議 300 DPI 以上
- PDF 建議為掃描或圖像式 PDF
- 檔案名稱避免使用特殊符號

---

## 登入與存取

### 存取位址

```
主頁面:      http://[內部IP]:8080
管理後台:    http://[內部IP]:8080/admin
批次處理:    http://[內部IP]:8080/batch-tasks
```

### 存取權限

- ✅ 本系統僅限**授權人員**使用
- ✅ 須透過**內部網路**存取
- ✅ 使用特定**指定裝置**操作
- ❌ 不對外開放,無法從外部網路存取

### 首次使用

1. 確認您的電腦已連接內部網路
2. 開啟瀏覽器 (建議使用 Chrome)
3. 輸入系統網址
4. 看到系統首頁表示連線成功

---

## 功能說明

### 單檔 OCR 處理

**適用情境**: 處理少量文檔 (1-10 份)

#### 操作步驟

1. **進入首頁**
   - 訪問 `http://[內部IP]:8080`

2. **上傳檔案**
   - 點擊「選擇檔案」按鈕
   - 選擇要處理的圖片或 PDF
   - 確認檔案已正確上傳

3. **設定關鍵字**
   - 在「關鍵字」欄位輸入要擷取的欄位名稱
   - 每行輸入一個關鍵字
   - 範例:
     ```
     姓名
     身分證字號
     地址
     電話
     ```

4. **選擇處理選項** (進階設定)
   - ☑️ **文檔方向分類**: 自動偵測並校正文檔方向
   - ☑️ **文檔展平**: 修正彎曲或傾斜的文檔
   - ☑️ **印章識別**: 識別文檔中的印章
   - ☑️ **表格識別**: 識別並解析表格內容 (預設勾選)
   - ☑️ **使用 LLM 擷取**: 使用 AI 智能擷取關鍵字 (預設勾選,建議保持)

5. **執行識別**
   - 點擊「上傳並識別」按鈕
   - 等待處理完成 (通常 10-30 秒)

6. **查看結果**
   - 系統會顯示識別的文字內容
   - 擷取的關鍵字會以表格形式呈現
   - 可下載處理後的標註圖片

#### 範例: 處理身分證

1. 上傳身分證掃描檔
2. 輸入關鍵字:
   ```
   姓名
   身分證字號
   出生日期
   ```
3. 勾選「文檔方向分類」
4. 點擊「上傳並識別」
5. 查看擷取結果

---

### PDF 頁面匹配

**適用情境**: 從多頁 PDF 中找出特定格式的頁面 (如公文正本頁)

#### 操作步驟

1. **進入頁面匹配功能**
   - 首頁點擊「PDF 頁面匹配」標籤頁

2. **上傳 PDF 文件**
   - 選擇要處理的多頁 PDF

3. **上傳範本圖片**
   - **正例範本**: 上傳您想要找的頁面範例 (1-3 張)
   - **反例範本** (選填): 上傳想要排除的頁面範例

   💡 **範本選擇技巧**:
   - 正例: 選擇典型的目標頁面 (如公文正本)
   - 反例: 選擇容易混淆的頁面 (如影本頁、附件頁)
   - 建議使用清晰、完整的範本

4. **調整匹配參數**
   - **正例閾值** (預設 0.25): 匹配頁面與正例的最低相似度
   - **反例閾值** (預設 0.30): 匹配頁面與反例的最高相似度
   - **跳過廢止頁面**: 自動跳過包含「廢止」字樣的頁面

5. **設定關鍵字並執行**
   - 輸入要擷取的關鍵字
   - 點擊「開始匹配並識別」
   - 等待處理完成

6. **查看匹配結果**
   - 系統會顯示匹配的頁碼與相似度分數
   - 顯示匹配頁面的OCR結果
   - 顯示擷取的關鍵字

#### 範例: 找出公文正本頁

1. 上傳多頁公文 PDF
2. 上傳正例範本 (公文正本頁截圖)
3. 上傳反例範本 (公文影本頁截圖)
4. 設定正例閾值 0.25, 反例閾值 0.30
5. 勾選「跳過廢止頁面」
6. 輸入關鍵字: 發文字號、主旨、受文者
7. 執行匹配
8. 確認找到的是正本頁

---

### 批次處理

**適用情境**: 處理大量文檔 (100+ 份 PDF)

批次處理分為**兩個階段**:
- **第一階段 (CLIP 匹配)**: 從每個 PDF 找出匹配的頁面
- **第二階段 (OCR 識別)**: 對匹配的頁面進行 OCR 與關鍵字擷取

#### 操作步驟

##### 步驟 1: 創建批次任務

1. **進入批次處理頁面**
   - 訪問 `http://[內部IP]:8080/batch-tasks`

2. **點擊「新增任務」**
   - 輸入任務名稱 (如: 2025年1月公文處理)
   - 輸入來源目錄路徑
     - Windows 範例: `C:\Documents\PDFs`
     - 網路磁碟範例: `\\server\share\documents`

3. **確認掃描結果**
   - 系統會自動掃描目錄下的所有 PDF
   - 顯示找到的檔案數量
   - 確認後創建任務

##### 步驟 2: 配置第一階段 (CLIP 匹配)

1. **進入任務詳情頁**
   - 點擊剛創建的任務

2. **點擊「配置第一階段」**
   - 上傳正例範本圖片 (必填)
   - 上傳反例範本圖片 (選填)
   - 設定相似度閾值:
     - 正例閾值: 0.25 (預設)
     - 反例閾值: 0.30 (預設)
   - 選擇是否跳過廢止頁面

3. **保存配置並開始處理**
   - 點擊「保存配置並開始處理」
   - 系統開始批次匹配

4. **監控進度**
   - 即時查看處理進度
   - 查看成功/失敗數量
   - 可以暫停或停止任務

##### 步驟 3: 配置第二階段 (OCR 識別)

1. **等待第一階段完成**
   - 確認所有檔案已完成匹配

2. **點擊「配置第二階段」**
   - 輸入要擷取的關鍵字 (按 Enter 新增)
   - 範例: 發文字號、主旨、受文者、發文日期
   - 選擇 OCR 處理選項:
     - ☑️ 表格識別 (建議勾選)
     - ☑️ 使用 LLM 擷取關鍵字 (建議勾選)

3. **保存配置並開始處理**
   - 點擊「保存配置並開始處理」
   - 系統開始批次 OCR

4. **監控進度**
   - 即時查看 OCR 進度
   - 查看關鍵字擷取情況

##### 步驟 4: 匯出結果

1. **等待第二階段完成**
   - 確認所有檔案已完成 OCR

2. **點擊「匯出 Excel」**
   - 系統會產生 Excel 檔案
   - 自動下載到您的電腦

3. **查看 Excel 內容**
   - 檔案名稱
   - 檔案路徑
   - 匹配頁面與分數
   - 擷取的關鍵字 (每個關鍵字一欄)
   - 處理時間與錯誤訊息

#### 批次處理提示

💡 **最佳實踐**:
- 建議每次處理不超過 1000 個檔案
- 先用小批次測試參數是否正確
- 定期檢查進度,及時發現問題
- 處理完成後立即匯出結果
- 完成的任務可以刪除以釋放空間

⚠️ **注意事項**:
- 處理過程中請勿關閉瀏覽器
- 可以暫停任務,稍後繼續
- 發生錯誤時可點擊「從失敗點繼續」
- 匹配結果儲存在資料庫,重新配置第二階段不會重新匹配

---

## 安全注意事項

### ⚠️ 重要安全守則

1. **資料保護**
   - ✅ 僅處理授權範圍內的文檔
   - ❌ 不得處理非授權或敏感文檔
   - ✅ 處理完畢後確認資料已匯出
   - ❌ 不得將系統存取權限分享給未授權人員

2. **系統使用**
   - ✅ 僅在指定裝置上使用
   - ❌ 不得從個人電腦或外部網路存取
   - ✅ 使用完畢後關閉瀏覽器分頁
   - ❌ 不得截圖或錄影系統操作畫面 (除非授權)

3. **檔案處理**
   - ✅ 確認上傳的檔案格式正確
   - ❌ 不得上傳可執行檔或腳本
   - ✅ 處理後的結果應妥善保存
   - ❌ 不得將結果傳送給未授權人員

4. **異常處理**
   - ✅ 發現異常立即停止操作並回報
   - ❌ 不得自行嘗試修復系統問題
   - ✅ 記錄錯誤訊息並通知管理員
   - ❌ 不得擅自修改系統設定

### 🔒 隱私保護

- 所有文檔處理均在**內部伺服器**執行
- **不會上傳**至任何外部服務或雲端
- 處理記錄儲存於**本地資料庫**
- 系統日誌僅記錄操作資訊,不記錄檔案內容

### 🚨 禁止行為

❌ **嚴禁以下行為,違者將取消使用權限**:

1. 將系統存取權限分享給他人
2. 處理非授權範圍的文檔
3. 嘗試入侵或測試系統安全性
4. 複製、下載或外傳系統程式碼
5. 使用自動化腳本大量提交請求

---

## 常見問題

### Q1: 為什麼 OCR 識別結果不準確?

**可能原因**:
- 文檔掃描品質不佳
- 文檔傾斜或彎曲嚴重
- 文字過小或模糊
- 複雜的背景或排版

**解決方法**:
- 勾選「文檔方向分類」和「文檔展平」
- 提供更高解析度的掃描檔 (建議 300 DPI)
- 調整關鍵字描述,使其更明確
- 使用範例文檔測試不同的處理選項

### Q2: 批次處理卡在某個檔案怎麼辦?

**解決方法**:
1. 點擊「暫停」按鈕
2. 檢查失敗的檔案 (查看錯誤訊息)
3. 修正問題檔案 (如格式錯誤、損壞)
4. 點擊「從失敗點繼續」
5. 系統會跳過失敗的檔案繼續處理

### Q3: 如何提高頁面匹配的準確度?

**技巧**:
1. **使用多張範本**: 上傳 2-3 張正例範本
2. **清晰的範本**: 使用完整、清晰的頁面截圖
3. **調整閾值**:
   - 太多誤匹配 → 提高正例閾值 (如 0.30)
   - 找不到頁面 → 降低正例閾值 (如 0.20)
4. **使用反例**: 上傳容易混淆的頁面作為反例

### Q4: Excel 匯出的關鍵字欄位是空的?

**可能原因**:
- LLM 服務未啟動
- OCR 識別結果為空
- 關鍵字在文檔中不存在

**檢查方法**:
1. 確認「使用 LLM 擷取關鍵字」已勾選
2. 查看單一檔案的 OCR 結果
3. 調整關鍵字名稱 (如「收文字號」改為「文號」)

### Q5: 系統顯示「CLIP 服務調用失敗」?

**可能原因**: CLIP 服務未啟動

**聯絡**: 請聯絡系統管理員重啟 CLIP 服務

### Q6: 可以同時執行多個批次任務嗎?

**可以**, 系統支援多個任務同時執行。但建議:
- 同時執行不超過 2 個大型任務
- 監控系統負載,避免影響效能
- 優先處理緊急任務

---

## 故障排除

### 無法存取系統

**症狀**: 瀏覽器顯示「無法連線」

**檢查步驟**:
1. ✅ 確認電腦已連接內部網路
2. ✅ 確認網址輸入正確 (`http://[內部IP]:8080`)
3. ✅ 嘗試 ping 伺服器 IP
4. ✅ 聯絡網管確認防火牆設定
5. ✅ 聯絡系統管理員確認服務是否執行中

### 上傳檔案失敗

**症狀**: 點擊「上傳」後沒有反應或顯示錯誤

**檢查步驟**:
1. ✅ 確認檔案格式正確 (JPG/PNG/PDF)
2. ✅ 確認檔案大小未超過限制 (< 100MB)
3. ✅ 檢查檔案是否損壞 (嘗試用其他程式開啟)
4. ✅ 清除瀏覽器快取後重試
5. ✅ 嘗試使用其他瀏覽器

### 處理時間過長

**症狀**: OCR 處理超過 5 分鐘仍未完成

**可能原因**:
- 檔案過大或頁數過多
- 系統負載過高
- 網路連線不穩定

**處理方式**:
1. 等待更長時間 (複雜文檔可能需要 10 分鐘)
2. 刷新頁面查看任務是否已完成
3. 聯絡管理員檢查系統狀態

### 批次任務停止不動

**症狀**: 進度停在某個百分比不動

**處理步驟**:
1. 刷新頁面查看最新狀態
2. 檢查任務狀態 (是否顯示「失敗」)
3. 點擊「從失敗點繼續」
4. 如仍無法解決,點擊「停止」後重新啟動

---

## 聯絡支援

### 技術支援

**系統管理員**: [請填入聯絡人姓名]
**電子郵件**: [請填入 Email]
**電話**: [請填入分機]
**辦公時間**: 週一至週五 09:00-18:00

### 回報問題

請提供以下資訊以加快處理速度:

1. **問題描述**: 詳細說明遇到的問題
2. **錯誤訊息**: 截圖或複製錯誤訊息
3. **操作步驟**: 重現問題的步驟
4. **檔案資訊**: 處理的檔案類型、大小
5. **發生時間**: 問題發生的日期時間
6. **使用者資訊**: 您的姓名與部門

### 建議與回饋

我們歡迎您的使用建議與回饋!

請透過以下方式提供:
- 📧 電子郵件: [請填入 Email]
- 📝 填寫意見回饋表單: [請填入表單連結]

---

## 附錄

### 鍵盤快捷鍵

| 快捷鍵 | 功能 |
|--------|------|
| `Ctrl + U` | 上傳檔案 |
| `Ctrl + Enter` | 執行識別 |
| `Esc` | 關閉彈窗 |

### 術語表

- **OCR**: 光學字符識別 (Optical Character Recognition)
- **CLIP**: 圖像相似度計算模型
- **LLM**: 大型語言模型,用於智能關鍵字擷取
- **閾值**: 判斷相似度的標準值
- **正例**: 想要匹配的目標範例
- **反例**: 想要排除的範例

### 版本歷史

- **v1.0** (2025-01-05): 初始版本發布

---

**文件結束**

*本文件內容如有更新,以最新版本為準。*
